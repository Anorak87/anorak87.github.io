<!DOCTYPE html>
<html>
<head>
	<title></title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script>

		$(function(){
		//aqui o seu código
		function Livro (titulo, genero, descricao, autor){

			this.titulo = titulo;
			this.genero = genero;
			this.descricao = descricao;
			this.autor = autor;

		}
		let acervoArray = new Array();
			$("#add_acervo").click(function(){
				//aqui a gente preenche a tabela ;-)
				let tituloLivro =$("#titulo").val();
				let descricao =$("#descricao").val();
				let genero =$("#genero").val();
				let autor =$("#autor").val();


				$("#acervo")
				.append(
					$("<tr>")
					.append(
						$("<td>").text(tituloLivro).addClass("titulo")
					)
					.append(
						$("<td>").text(descricao).addClass("descricao")
					)
					.append(
						$("<td>").text(genero).addClass("genero")
					)
					.append(
						$("<td>").text(autor).addClass("autor")
					)
					.append(
						$("<td>")
						.append($("<img>").attr({'src':'lixeira.png', 'width':'40px', 'height':'40px'}))
					)
					.addClass("livro")
				)

				$("#acervo").on("click","img", function(){
					$(this).parents("#acervo tr").remove();

				})
			})
			$("#salvar_no_bd").click(function() {
	$(".livro").each(function(idx, linha){
				 // pega a linha
					 let tit = $(this).find(".titulo").text();
					 let desc = $(this).find(".descricao").text();
					 let gen = $(this).find(".genero").text();
		 			 let aut = $(this).find(".autor").text();

				 let livro = new Livro(tit, gen, desc, aut);
				 console.log(livro);
				 acervoArray.push(livro);
				 $("input[name='acervo_post']").val(JSON.stringify(acervoArray));
	});
})

		});
	</script>
</head>
<body>

<fieldset>
	<legend>Cadastro de livros</legend>
	<input type="text" id="titulo" placeholder="titulo"><br>
	<textarea id="descricao"></textarea> <br>
	<select id="genero">
		<option value="Romance">Romance</option>
		<option value="Drama">Drama</option>
		<option value="Terror">Terror</option>
		<option value="Ficção">Ficção</option>
		<option value="Técnico">Técnico</option>
	</select>
	<br>
	<input type="text" id="autor" placeholder="autor">
	<br>
	<button id="add_acervo">Adicionar a lista</button>
</fieldset>

<h1>Catálogo</h1>

	<table id="acervo" style="border: 1px solid black;">
		<tr><th>Título</th><th>Descrição</th><th>Gênero</th><th>Autor</th><th></th></tr>
	</table>


	<form action="https://rafaelescalfoni.net/web/livros.php"
		method="post">
		<input type="hidden" name="acervo_post">
		<input type="submit" id="salvar_no_bd" value="Salvar no BD">
	</form>
</body>
</html>
